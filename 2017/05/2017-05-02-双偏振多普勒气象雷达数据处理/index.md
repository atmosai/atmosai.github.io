# 双偏振多普勒气象雷达数据处理


C波段双线偏振多普勒天气雷达是目前国内最先进的雷达系统，采用高相位稳定的全相参脉冲多普勒和同时发射同时接收的双线偏振体制，具有高增益低副瓣天线系统，大功率双路馈线和功率分配器，大功率全固态调制器速调管发射机，双路低噪声大动态线性范围接收机，高精度数字中频双偏振多普勒信号处理器和双偏振多普勒数据处理和显示终端，提供高精度双偏振强度和多普勒数据、丰富的多普勒应用软件产品和图形图像产品。通过双偏振技术的应用，对云和大气水凝结物的物理特性有了更深的了解，提高了雷达的测雨精度，提高了雷达对冰雹等大气水凝结物的识别能力，预报云内过冷水的出现，从而更准确地进行气象预报。

C波段双偏振多普勒雷达和S波段雷达在读取时有所不同。S波段雷达数据的存储均为int型，且存储数据均为4字节，但是C波段双偏振多普勒雷达存储数据时，不同的变量存储为不同的类型，而且字节大小也不同。因此，在读取时不能采取之前的方式，只能逐次读取。关于数据说明的具体信息查阅文档。

### 读取流程

由于双偏振雷达的数据结构和S波段多普勒雷达的数据结构不同，因此，在确定读取流程之前，先看一下雷达数据的存储结构:

![](https://github.com/bugsuse/blogpic/blob/master/2017/05/02/fig1.jpg?raw=true)

存储的数据主要由：产品通用数据块和径向数据块构成，其中径向数据块由每一条径向数据构成。

**产品通用数据块**

存储了关于雷达站点的信息以及雷达所执行的任务类型等信息，对于正确读取数据非常重要。但是此部分并未包含任何产品数据。

**径向数据块**

由每一条径向所组成，每一条经向中包含了此径向的基本信息：**径向状态**，当前径向数，仰角数，**仰角**，**方位角**及moment数等信息，对于确定径向属于哪一次仰角的扫描至关重要。

其中所包含的 moment头信息中存储了相关产品的信息，对于产品解码及产品数据的大小非常重要。

当然，最后所存储的产品数据也是不能缺少的。

处理流程如下：

- **读取雷达站点信息**

- **读取指定的仰角的信息**
  由于执行的某一仰角扫描时，仰角值存在一定误差，并不是固定值。因此，此处读取时通过指定cut数来读取。而cut相关信息全部存储在径向信息之前，在确定cut数之后，直接读取相应的cut信息，然后跳到第一条径向处，开始读取数据。

- **读取指定的产品数据**
  为了确定读取到了指定的cut所对应的产品数据，需要确定径向状态。因为每一次仰角开始时径向状态是0（体扫开始时是3，即第一条径向），结束时是2（体扫结束是4，即最后一条径向）。通过记录径向开始的值出现的次数确定当前所读取的cut。

- **然后就是读取每一条径向的指定产品数据**

  为了确定指定产品数据，需要知道moment头信息中的 data type 值，然后和指定的产品类型值进行对比。关于产品类型值可以查看数据说明。

- **最后，转换坐标为经纬度坐标**

  大体的流程如上所述，可以对照[源代码](https://pan.baidu.com/s/1kVE5JWr)来看读取流程。(获取码:`6hdm`)

  最后是读取后的效果图：

  ![](https://github.com/bugsuse/blogpic/blob/master/2017/05/02/fig2.jpg?raw=true)

雷达数据基本都是二进制数据，在处理这类数据时一定要仔细阅读数据说明文档，对照数据说明文档进行处理。


